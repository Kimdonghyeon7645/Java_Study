# 2-3. 타입 변환

데이터 타입을 다른 타입으로 변환하는 타입 변환은 두가지 종류가 있다.  
**자동(묵시적) 타입 변환과 강제(명시적) 타입 변환** 이다.  

## 자동 타입 변환

**자동 타입 변환(프로모션, Promotion)** 은 프로그램 실행 중 자동으로 타입 변환되는 것을 말한다.  
이 자동 타입 변환은 작은 메모리 크기의 타입이 큰 메모리 크기를 가지는 타입에 저장될 때 발생한다.  

자동 타입 변환이 발생되면, 변환 이전 값과 이후 값은 동일(손실 없이 그대로 보존)하나 타입만 확장된다.  
다만 자동 타입 변환의 단 한가지 예외로, byte 에서 char 로 변환 할때, 
byte는 음수가 저장될 수 있지만, char는 음수가 저장될 수 없기에, 자동 변환 시킬 수 없다. 

## 강제 타입 변환 

큰 메모리 크기의 타입을 바로 작은 메모리 크기의 타입으로 담을 수 없지만,  
작은 메모리 크기에 맞도록 쪼개 넣으면 담을 수 있는데, 이것이 **강제 타입 변환(캐스팅, Casting)** 이라 한다.  

강제 타입 변환(캐스팅)은 캐스팅 연산자인 괄호()를 사용하는데, 형식은 아래와 같다.  
```[작은 크기 타입 변수] = ([작은 크기 타입]) [큰 크기 타입 값]```  
이렇게 되면 큰 크기 타입의 값이, 작은 크기 타입의 byte 크기만큼 남기고, 그것을 제외한 앞부분의 byte가 짤려서 저장된다.  

예를 들어 int 타입의 값을 byte 타입으로 변환하는 경우, 총 int 타입의 4바이트중에서 앞의 3바이트는 버려지고 끝의 1바이트만 유지된다.  
(만약 앞의 3바이트가 모두 0이라면(=byte의 범위 안에 속하는 경우), 값이 손실없이 변환된다.)

특히, int 타입을 char 타입으로, 실수 타입을 정수 타입으로 변환할 때, 자동 타입 변환이 안되므로 강제 타입 변환을 이용한다.  

### 강제 타입 변환의 주의점

이때 값의 손실이 발생하면 올바른 타입 변환이 아니므로, 타입 변환시 값이 보존되도록 해야한다.  
이 방법에는 손실이 발생하는 데이터인지 검사하는 식을 추가하는 방법과,   
정수와 실수사이에선 double을 사용하는 것이다.  
 
- 손실이 발생하는 데이터인지 검사하는 식 추가

자바에서는 코드의 데이터 값을 검사할 수 있게, boolean, char 타입을 제외한 모든 타입에 최대값(max), 최소값(min)을 상수로 제공한다.  

기본 타입|최대값 상수|최소값 상수
:---:|:---:|:---:
byte|Byte.MAX_VALUE|Byte.MIN_VALUE
short|Short.MAX_VALUE|Short.MIN_VALUE
int|Integer.MAX_VALUE|Integer.MIN_VALUE
long|Long.MAX_VALUE|Long.MIN_VALUE
float|Float.MAX_VALUE|Float.MIN_VALUE
double|Double.MAX_VALUE|Double.MIN_VALUE

이것들로 강제 타입 변환을 할 때, 변환전 검사를 해주는 식을 추가할 수 있다. 
```java
int i = 128;

if ( (i < Byte.MIN_VALUE) || (i > Byte.MAX_VALUE) ) {
    System.out.println("byte 타입 변환 불가");
} else {
    byte b = (byte) i;
    System.out.println(b);
}
```

- 정수와 실수 타입 변환시 정밀도 손상 고려(double 타입 사용)

int 값을 float 값으로 변환할려면, 23비트로 표현 가능해야 하지만,  
int 값은 32비트 이므로, 23비트가 넘어가는 int 타입 값은 float로 변환할 때 근사치로 변환된다.  
여기서 정밀도 손상이 발생하는 데, 이것을 방지하기 위해서, 52비트를 차지하는 double 타입을 사용하는 것이다. 

double은 가수가 52비트이기에, int 크기인 32비트를 모두 손실없이 변환할 수 있다.  

## 연산식에서 자동 타입 변환

연산은 같은 타입의 피연산자(이걸 operand라고 한다.) 간에서 수행되기에,  
서로 피연산자의 타입이 다르면, 둘 중 메모리 크기가 큰 타입으로 자동 변환된 후 연산을 수행한다.  

그래서 int 와 double 두 타입을 연산하면 둘 중 메모리가 큰 double 타입으로 타입이 통일되서 자동 변환되고,  
연산 결과도 double로 나오게 된다.  
그렇기에 연산 결과를 int로 보고 싶으면, double 타입의 값을 int로 강제 변환하고 연산해야 된다. 

그리고 자바는 정수 연산을 int 타입을 기본으로 하기에, 이보다 작은 타입(byte, char, short)은  
int 타입으로 자동 변환된 후 연산이 수행된다.  
그래서 int 보다 작은 타입(byte, char, short)의 연산은 수행한 후에 다시 결과값을 원래 타입으로 강제 변환 해야된다.  
